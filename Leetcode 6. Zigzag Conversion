class Solution {
public:
    string convert(string s, int numRows) {
        int n = s.size();
        int diag = numRows - 2;
        vector<vector<string>> zigzag;
        int i = 0;

        while (i < n) { 

            vector<string> col;
            for (int j = 0; j < numRows && i < n; j++) {
                col.push_back(string(1, s[i++]));
            }
            zigzag.push_back(col);
 
            for (int d = 0; d < diag && i < n; d++) {
                vector<string> diagVec(numRows, "");
                diagVec[numRows - 2 - d] = string(1, s[i++]);
                zigzag.push_back(diagVec);
            }
        }
 
        string result;
        for (int r = 0; r < numRows; r++) {
            for (auto& vec : zigzag) {
                if (r < vec.size() && !vec[r].empty())
                    result += vec[r];
            }
        }

        return result;
    }
};
